# КИКСТАРТ 
# TODO сделать нормальный YML уже!!
# 
#sudo docker exec -it db pg_dump -U odoo darfchain > darfchain0210.pgsql
docker run -d -e POSTGRES_USER=odoo -e POSTGRES_PASSWORD=odoo -e POSTGRES_DB=postgres --name db postgres:10

# https://stackoverflow.com/questions/30641512/create-database-from-command-line
#cat ./darfchain0210.pgsql  | docker exec db psql -U odoo -d darfchain
docker cp ./darfchain0210.pgsql db:/

#docker exec -it db psql -U odoo  -c "DROP DATABASE DARFCHAIN"
#  psql -U odoo -d postgres -c "DROP DATABASE DARFCHAIN"
# >>DROP DATABASE
#  psql -U odoo -d postgres -c "create database darfchain;"
# >>CREATE DATABASE
#  psql -U odoo -d darfchain < /darfchain0210.pgsql

docker exec -it db  psql -U odoo -d postgres
# внутре
psql -U odoo -d postgres
# внутре psqlя 
create database darfchain; 
\c darfchain 
\i /darfchain0210.pgsql \
#если  ошибки ftp
DROP DATABASE DARFCHAIN 



docker run --restart=always  -d -p 8069:8069 --name odoo --link db:db --mount type=bind,source=/512-2/dfd/angeles/3ae8838c4b29736cd650a9c1f957bf36a78f52aa7b486cfdfd93e83c97e1334d/_data/filestore/,target=/var/lib/odoo/filestore/ --mount type=bind,source=/512-2/dfd/Angeles/addons11,target=/mnt/extra-addons/   -t odoo:11.0 

#если порт 80 занят какой-то другой хренью, нужно поменять порт в  -p 80: потом  удалить и пересобрать контейнер


docker exec -itu root odoo bash
# внутре докера odoo
apt update && apt install python3-dev gcc mc python3-passlib 
#pip3 install wheel cpython
# потом, если нормально установится!
#pip3 install  web3  
pip3 install mailchimp3
#далее обновляем модели проекта
 odoo -p 8015 -d postgres -r odoo -w odoo --db_host DB --db_port 5432 -u all
#потом выйти , снаружи, 
docker restart odoo
#в браузере на
# при коммите изменений   
docker exec -u root odoo  odoo -p 8015 -d postgres -r odoo -w odoo --db_host DB --db_port 5432 -u darfproject
# когда обновится - ctrl+c 
docker restart odoo

